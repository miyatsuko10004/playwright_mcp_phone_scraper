# 要件定義書

## 1. 概要

Excelファイルに記載された企業名リストを基に、Playwright MCPを使用して各企業の電話番号をウェブサイトから取得する。

## 2. 目的

*   企業名から電話番号を効率的に収集する。
*   手動での情報収集にかかる時間と労力を削減する。

## 3. 機能要件

### 3.1. 入力

*   企業名が記載されたExcelファイル（例: `companies.xlsx`）。
*   企業名が記載されているシート名と列名を指定できること。

### 3.2. 処理

*   Excelファイルから企業名リストを読み込む。
*   各企業名について、以下の処理を実行する。
    *   検索エンジン（例: Google）を使用して企業名を検索する。
    *   検索結果から企業の公式サイトを特定し、アクセスする。
    *   公式サイト内から電話番号を抽出する。
    *   電話番号が見つからない場合、その旨を記録する。
*   Playwright MCPを使用して、ブラウザ操作を自動化する。

### 3.3. 出力

*   企業名と取得した電話番号、または「電話番号が見つかりませんでした」という情報を含むCSVファイル（例: `phone_numbers.csv`）。
*   処理中に発生したエラーや警告をログに出力する。

## 4. 非機能要件

### 4.1. 性能

*   1000件の企業名リストを処理するのに、許容可能な時間内に完了すること。

### 4.2. 信頼性

*   ウェブサイトの構造変更やアクセスエラーに対して、ある程度の耐性を持つこと。
*   エラー発生時に処理が停止せず、スキップして続行できること。

### 4.3. 保守性

*   コードが読みやすく、変更しやすい構造であること。
*   ウェブサイトのセレクタ変更に対応しやすい設計であること。

### 4.4. セキュリティ

*   個人情報や機密情報の取り扱いには十分注意すること。

## 5. 技術スタック

*   Python (venvの使用を推奨)
*   Playwright (Playwright MCP)
*   Pandas (Excelファイルの読み書き)
*   Openpyxl (Excelファイルの読み書き)

## 6. 今後の課題・検討事項

*   CAPTCHAやボット対策への対応。
*   複数の電話番号が見つかった場合の処理。
*   異なるウェブサイト構造への対応方法。
*   プロキシの利用。
*   ヘッドレスモードでの実行。
